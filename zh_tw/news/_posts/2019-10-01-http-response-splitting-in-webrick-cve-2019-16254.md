---
layout: news_post
title: "CVE-2019-16254：WEBrick 存在 HTTP 響應切分風險（額外修復）"
author: "mame"
translator: "JuanitoFatas"
date: 2019-10-01 11:00:00 +0000
tags: security
lang: zh_tw
---

Ruby 自帶的 WEBrick 存在 HTTP 響應切分風險。此風險的識別號為 [CVE-2019-16254](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16254)。

## 細節

若使用 WEBrick 的程式插入不受信任的輸入，攻擊者可以利用此風險來插入一個換行符來分隔 HTTP 標頭，進而注入惡意內容給客戶端。這個風險和 [CVE-2017-17742]({% link zh_tw/news/_posts/2018-03-28-http-response-splitting-in-webrick-cve-2017-17742.md %}) 相同。之前的修復只解決了 CRLF vector，但沒有處理獨立的 CR 及 LF。

建議所有使用受影響版本的使用者儘速升級。

## 受影響的版本

* 所有 Ruby 2.3 及更早版本
* Ruby 2.4 系列： Ruby 2.4.7 及更早版本
* Ruby 2.5 系列： Ruby 2.5.6 及更早版本
* Ruby 2.6 系列： Ruby 2.6.4 及更早版本
* Ruby 2.7.0-preview1
* 早於 ruby master commit 3ce238b5f9795581eb84114dcfbdf4aa086bfecc 的全部版本

## 致謝

感謝 [znz](https://hackerone.com/znz) 發現此問題。

## 歷史

* 最早發佈於 2019-10-01 11:00:00 (UTC)
